"0","## Calculate Adjusted Choice Probability"
"0","adjusted_choice_probability <- function(df, parameter, alpha_flg){"
"0","  output <- df %>% "
"0","    dplyr::mutate(exp_utility = "
"0","                    ifelse(alpha_flg == 1, alpha, 1) *"
"0","                    exp(parameter[1]"
"0","                        + parameter[2] * p"
"0","                        + parameter[3] * log(f)"
"0","                        + parameter[4] * アクセシビリティ"
"0","                        + parameter[5] * 鉄道ダミー"
"0","                        + parameter[6] * 一便あたり座席数"
"0","                        + parameter[7] * 一便あたり貨物"
"0","                        + parameter[8] * 所要時間)) %>% "
"0","    dplyr::group_by(i, j) %>% "
"0","    dplyr::mutate(sum_exp_utility = sum(exp_utility)) %>% "
"0","    ungroup() %>% "
"0","    dplyr::mutate(adjusted_choice_probability ="
"0","                    exp_utility / sum_exp_utility)"
"0","  "
"0","  return(output)"
"0","}"
"0",""
"0","## Calculate Frequency"
"0","calculate_frequency <- function(df, parameter, alpha_flg, n){"
"0","  output <- df %>% "
"0","    adjusted_choice_probability(parameter, alpha_flg) %>% "
"0","    dplyr::mutate(f_renewal = "
"0","                    ifelse(airlineNo == n,"
"0","                           OD * adjusted_choice_probability / (Seat * LF / 100),"
"0","                           f),"
"0","                  f_renewal = "
"0","                    ifelse(f_renewal < 1, 1, f_renewal))"
"0","  "
"0","  return(output)"
"0","}"
"0",""
"0",""
"0","## Objective Function for Profit Maximization"
"0","objective <- function(objective_price, df, parameter, alpha_flg, n){"
"0","  df <- df %>% "
"0","    dplyr::mutate(p = ifelse(airlineNo == n,"
"0","                             objective_price, "
"0","                             p)) %>% "
"0","    adjusted_choice_probability(parameter, alpha_flg) %>% "
"0","    dplyr::filter(airlineNo == n) %>% "
"0","    dplyr::mutate(profit = (p - MC) * OD * adjusted_choice_probability)"
"0","    "
"0","  output <- sum(df$profit)"
"0",""
"0","  return(output)"
"0","}"
"0",""
