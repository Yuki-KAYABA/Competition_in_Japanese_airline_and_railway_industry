"0","## Combine airports"
"0","airline <- airline %>% "
"0","  ## Merge fringe airports into major ones"
"0","  dplyr::mutate(空港i = case_when(空港i == ""成田"" ~ ""羽田"","
"0","                                空港i == ""伊丹"" ~ ""関西国際"", "
"0","                                空港i == ""南紀白浜"" ~ ""関西国際"","
"0","                                空港i == ""神戸"" ~ ""関西国際"","
"0","                                空港i == ""北九州"" ~ ""福岡"", "
"0","                                空港i == ""佐賀"" ~ ""福岡"","
"0","                                空港i == ""中部"" ~ ""名古屋"","
"0","                                空港i == ""小牧"" ~ ""名古屋"","
"0","                                TRUE ~ 空港i),"
"0","                空港j = case_when(空港j == ""成田"" ~ ""羽田"","
"0","                                空港j == ""伊丹"" ~ ""関西国際"", "
"0","                                空港j == ""南紀白浜"" ~ ""関西国際"","
"0","                                空港j == ""神戸"" ~ ""関西国際"","
"0","                                空港j == ""北九州"" ~ ""福岡"", "
"0","                                空港j == ""佐賀"" ~ ""福岡"","
"0","                                空港j == ""中部"" ~ ""名古屋"","
"0","                                空港j == ""小牧"" ~ ""名古屋"","
"0","                                TRUE ~ 空港j)) %>% "
"0","  # Fares are translated to one-way"
"0","  dplyr::mutate(費用 = 費用 / 2) %>% "
"0","  # Combine ODs"
"0","  dplyr::group_by(空港i, 空港j) %>% "
"0","  dplyr::mutate(i = min(i),"
"0","                j = min(j),"
"0","                費用 = sum(航空便数 * 費用) / sum(航空便数), ## Weighted Mean"
"0","                所要時間 = sum(航空便数 * 所要時間) / sum(航空便数), ## Weighted Mean"
"0","                航空便数 = 365 * sum(航空便数), "
"0","                滞在可能時間 = max(滞在可能時間), "
"0","                エアライン参入数 = mean(エアライン参入社数)) %>% "
"0","  dplyr::select(空港i, 空港j, i, j, 所要時間, 費用, "
"0","                航空便数, 滞在可能時間, エアライン参入数) %>% "
"0","  dplyr::distinct()"
"0",""
"0","# Merge airline data into the whole airline dataframe"
"0","dataframe.airline <- dataframe.airline %>% "
"0","  dplyr::left_join(airline, by = c(""X47ゾーンi"" = ""i"","
"0","                                   ""X47ゾーンj"" = ""j"")) %>% "
"0","  # Add Accessibility"
"0","  dplyr::left_join(accessibility.airport, by = c(""X207ゾーン名j"" = ""ゾーン"")) %>% "
"0","  dplyr::left_join(accessibility.airport, by = c(""X207ゾーン名i"" = ""ゾーン"")) %>% "
"0","  dplyr::mutate(アクセシビリティ = アクセシビリティ.x + アクセシビリティ.y) %>% "
"0","  dplyr::select(""X47ゾーンi"", ""X47ゾーンj"", ""i"", ""j"", everything()) %>% "
"0","  # Add OD"
"0","  dplyr::left_join(OD.207, by = c(""X207ゾーンi"", ""X207ゾーンj"")) %>% "
"0","  # Add Railway Dummy"
"0","  dplyr::mutate(鉄道ダミー = 0) %>% "
"0","  # Select"
"0","  dplyr::select(""i"", ""j"", ""X207ゾーンi"", ""X207ゾーンj"", ""X47ゾーンi"", ""X47ゾーンj"", "
"0","                ""X207ゾーン名i"", ""X207ゾーン名j"", ""所要時間"", ""費用"", ""航空便数"", "
"0","                ""滞在可能時間"", ""アクセシビリティ"", ""鉄道ダミー"", ""エアライン参入数"", "
"0","                ""airline"", ""all2"", ""all"") %>% "
"0","  dplyr::rename(x = airline, OD1 = all2, OD2 = all)"
"0",""
"0","# summary(dataframe.airline)"
"0",""
"0",""
"0","## Railway Data"
"0","dataframe.railway <- dataframe.railway %>% "
"0","  dplyr::left_join(railway, by = c(""最寄りi"" = ""i"", ""最寄りj"" = ""j"")) %>% "
"0","  dplyr::left_join(railwaycost, by = c(""最寄りi"" = ""駅i"", ""最寄りj"" = ""駅j"")) %>% "
"0","  dplyr::left_join(accessibility.station, by = c(""X207ゾーン名j"" = ""ゾーン"")) %>% "
"0","  dplyr::left_join(accessibility.station, by = c(""X207ゾーン名i"" = ""ゾーン"")) %>% "
"0","  dplyr::mutate(アクセシビリティ = アクセシビリティ.x + アクセシビリティ.y) %>% "
"0","  dplyr::left_join(OD.207, by = c(""X207ゾーンi"", ""X207ゾーンj"")) %>% "
"0","  # Add Railway Dummy and Other Airline-Related Variables"
"0","  dplyr::mutate(鉄道ダミー = 1, "
"0","                航空便数 = 1, "
"0","                エアライン参入数 = 0) %>% "
"0","  # Select"
"0","  dplyr::select(""i.x"", ""j.x"", ""X207ゾーンi"", ""X207ゾーンj"", ""X47ゾーンi"", ""X47ゾーンj"", "
"0","                ""X207ゾーン名i"", ""X207ゾーン名j"", ""所要時間.1"", ""cost"", ""航空便数"", "
"0","                ""滞在可能時間.1"", ""アクセシビリティ"", ""鉄道ダミー"", ""エアライン参入数"", "
"0","                ""railway"", ""all2"", ""all"", ""distance"") %>% "
"0","  dplyr::rename(i = i.x, j = j.x, 所要時間 = 所要時間.1, 費用 = cost, "
"0","                滞在可能時間 = 滞在可能時間.1, "
"0","                x = railway, OD1 = all2, OD2 = all,"
"0","                路線距離 = distance) %>% "
"0","  # Transform Data Type"
"0","  dplyr::mutate_at(vars(所要時間, 滞在可能時間, 費用),"
"0","                   ~ as.numeric(.))"
"2","Warning: [38;5;255mThere were 2 warnings in `mutate()`.
The first warning was:[39m
[38;5;255m[36mℹ[38;5;255m In argument: `滞在可能時間 = (structure(function (..., .x = ..1, .y = ..2, . = ..1) ...`.[39m
Caused by warning in `as.numeric()`:
[33m![39m NAs introduced by coercion
[38;5;255m[36mℹ[38;5;255m Run ]8;;ide:run:dplyr::last_dplyr_warnings()dplyr::last_dplyr_warnings()]8;; to see the 1 remaining warning.[39m"
"0","# summary(dataframe.railway)"
